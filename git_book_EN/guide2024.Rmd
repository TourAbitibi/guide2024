--- 
title: "Tour de l'Abitibi Glencore 2024 - Technical Guide"
author: "Bruno Gauthier"
institute: "Tour de l'Abitibi"
date: "Last update : `r Sys.Date()`"
site: bookdown::bookdown_site
documentclass: book
toc-title: "Contents"
favicon: "../img/favicon.jpg"
#papersize: letter
#fontsize: 12pt
# url: your book url like https://bookdown.org/yihui/bookdown
# cover-image: path to the social sharing image like images/cover.jpg
description: |
    Technical guide for the 2024 Tour de l'Abitibi, a stage of the UCI Nations Cup.
    Presentation of the program, courses and regulations for the event.
suppress-bibliography: yes
#link-citations: yes
#github-repo: rstudio/bookdown-demo
---

# Presentation

```{r here, include=FALSE}
# Gestion avec here
here::i_am("guide2024.Rproj")
```

```{r call_Libs_Vars, include=FALSE}
# Appel des librairies et variables partagées
source(here::here("code","_LibsVars.R"))

# Dates
source(here("code", "_Dates.R"))

# Utilisation Résultats
source(here("code", "_useResults.R"))

# Pour accès aux données du fichier excel Itineraires.xlsx
source(here("code","_import_itineraire.R"))

# Pour accès aux tracés et aux POI d'étapes
parcours <- st_read(here("gpx","output","parcours.shp"))%>% 
  mutate(name = str_replace(name, "Étape", "Stage"),
                name = str_replace(name, "CLMI", "ITT"))
points <- st_read(here("gpx","output","points_parcours.shp"))

# Langue
lang <- "EN"

# Locale
## https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/locales
{if (lang == "FR") Sys.setlocale("LC_TIME", locale = "fr_CA.UTF-8") 
  else Sys.setlocale("LC_TIME", locale = "en_US.UTF-8") }

opts_chunk$set( tidy = FALSE, comment = NA,
                fig.align = "center",
                fig.width = 7.5, fig.height = 7.5,
                fig.retina = 2, cache = FALSE,
                class.output = "codeout",
                warning = FALSE,
                message = FALSE,
                quiet=TRUE)

```


```{r logo_tour_sponsor, echo=TRUE, echo=FALSE, out.width= "25%", out.extra='style="float:right; padding:10px"'}
knitr::include_graphics(here("img", "logo", "TA_Glencore.png"))
```

<br/>

Welcome to the `r params$edition`^th^ edition of the **`r params$annee` Tour de l'Abitibi `r params$sponsor`**, which will be held from `r dates_EN %>% filter(code=="Mar") %>% pull(jsem_jour_mois_an)` to `r dates_EN %>% filter(code=="Dim") %>% pull(jsem_jour_mois_an)` in `r params$ville`.

In this online technical guide, you will find all the details about the event, as well as details about your stay in Abitibi-Témiscamingue. 

<br/>

```{r map_globale, echo = FALSE, eval = TRUE}
# Visualisation
mapview(parcours ,
        lwd = 2.5,
        alpha = 0.7,
        z = "name",
        color = palette.colors(n=7, palette="ggplot2"),
        layer.name = "Stage")
```

<br/>

You can also download a condensed version of the technical guide, containing only the stages descriptions, by clicking on the PDF icon at the top left of the screen.

<br/>

```{r lien_pdf, out.width="40%",fig.align='center',  echo = FALSE, eval = TRUE}
knitr::include_graphics(here("img", "support", "lien_pdf.png"))
```



----

*Si vous cherchez la version française du guide : [Guide Technique](../FR/)*

<!--chapter:end:index.Rmd-->

# Welcoming words {#welcome}

### A word from the chairwoman of the board {-}

\linebreak

```{r photo_pres, echo=TRUE, echo=FALSE, out.width= "35%", out.extra='style="float:right; padding:10px"'}
knitr::include_graphics(here("img", "photos", "pres.png"))
```


On behalf of the entire board of directors and the organizing committee, I warmly welcome you to the 54^th^ Tour de l'Abitibi Glencore. We are extremely proud of this cycling event, which remains unique in its kind in North America! Its longevity is a testament to the passion, enthusiasm, and unwavering commitment of the residents of the Abitibi-Témiscamingue region.

For this 54^th^ Tour, we will be hosting young cyclists from all around the world, and we are excited to have even more international countries participating than last year. As in previous years, team supporters will have the opportunity to follow the races live on our website at <a href="https://www.tourabitibi.com" target="_blank">www.tourabitibi.com</a>.

I would like to express my deep gratitude to our many volunteers and our permanent team, who have worked tirelessly throughout the year to bring you a memorable event during Tour week in Val-d'Or. I would also like to extend a special thank you to our loyal and generous partners, without whom this event would not be possible, especially our title partner, Glencore.

On behalf of everyone who contributes to the success of this sporting competition, I would like to thank the cyclists and their companions for traveling to Abitibi-Témiscamingue. To all of you, I extend my best wishes for success and hope that your visit to our beautiful region will leave a lasting impression on your memories.



**Mélanie Rocher**    
Chairwoman of the board         
Tour Cycliste de l'Abitibi inc.   

```{r mots_logo_tour, echo=TRUE, echo=FALSE, fig.align='left', out.width= "25%"}
knitr::include_graphics(here("img", "logo", "TA_Glencore.png"))
```

<br/>

--- 

\pagebreak

<br/>

### A word from our title partner {-}

\linebreak

```{r photo_AlexisSegal, echo=TRUE, echo=FALSE, out.width= "35%", out.extra='style="float:right; padding:10px"'}

knitr::include_graphics(here("img", "photos", "comm_titre.jpg"))

```

Dear Partners and Volunteers,

We are delighted to renew our commitment to the Tour de l'Abitibi Glencore for a second year. Our support for this internationally renowned event aligns with our desire to promote the passion of young athletes, encourage healthy lifestyles, and contribute to regional vitality. It is with great pride that we support the only international-caliber junior cycling race in Canada!

We would like to congratulate the organizing committee and all the dedicated volunteers who contribute to the success of this event year after year. Through their commitment, they offer young people a truly extraordinary experience!

**Alexis Segal**   
Director of Government Relations and Public Affairs


```{r mots_logo_Glencore, echo=TRUE, echo=FALSE, fig.align='left', out.width= "35%"}
knitr::include_graphics(here("img", "logo", "Glencore.png"))
```

<br/>

---

\pagebreak

<br/>

### A word from `r params$ville` mayor {-}

\linebreak

```{r photo_maire, echo=TRUE, echo=FALSE, out.width= "35%", out.extra='style="float:right; padding:10px"'}

knitr::include_graphics(here("img", "photos", "maire_vd.png"))

```

Hello everyone,

As the mayor, it is my great pleasure to welcome you to Val-d'Or for this 54^th^ edition of the Tour de l’Abitibi Glencore. It is an honor to host you for this high-level sporting event that has been a source of pride for our region for over half a century!

Your presence brings a wave of dynamism to our city. You are a true source of inspiration for the population, especially for young enthusiasts of this spectacular sport. We admire your determination, sportsmanship, and unwavering perseverance. We hope that your experience in Val-d'Or meets your expectations.

To the coaches and companions of the athletes, we wish you a wonderful stay. It is always a pleasure to share our beautiful and vast region with you!

I am convinced that you will appreciate the warm welcome from our residents and the great involvement of the organizers, partners, and numerous volunteers. Thank you for contributing to the prominence of our area.

Enjoy the competition!

**Céline Brindamour**    
`r params$ville` mayor 
  

```{r mots_logo_amos, echo=TRUE, echo=FALSE, fig.align='left', out.width= "25%"}
knitr::include_graphics(here("img", "logo", "VilleVD.png"))
```

<br/>

---

\pagebreak

<br/>

### A word from the Minister {-}

\linebreak

```{r photo_ministre_gauche, echo=TRUE, echo=FALSE, out.width= "35%", out.extra='style="float:left; padding:10px"'}

knitr::include_graphics("https://coalitionavenirquebec.org/wp-content/uploads/2018/08/photo-profil-charest-isabelle-brome-missisquoi.png")

```

```{r photo_ministre_droite, echo=TRUE, echo=FALSE, out.width= "35%", out.extra='style="float:right; padding:10px"'}

knitr::include_graphics("https://coalitionavenirquebec.org/wp-content/uploads/2018/08/photo-profil-proulx-caroline-berthier-sans-main.png")

```



**A significant race in Abitibi-Témiscamingue**

The government of Quebec is pleased to support the Tour de l’Abitibi Glencore, which provides an opportunity for the best junior cyclists from here and abroad to compete in the 7 stages of the race, spanning 7 days and covering nearly 700 kilometers. This is a wonderful way to discover the region and to support extraordinary athletes who serve as inspiring role models for our youth.

This unique sporting event in America is one of the gatherings that boost the economy of the Abitibi-Témiscamingue region and promote the benefits of sports both among the local population and visitors. It contributes to showcasing the players in our events industry while highlighting the resilience and dedication of the athletes.

Congratulations to the organizing team, who have masterfully orchestrated this grand gathering. Every year, visitors can cheer on their favorite cyclists while taking the opportunity to explore the region.

Enjoy the event!

<br/>

**Isabelle Charest**      
Minister Responsible for Sport, Recreation and the Outdoors  

<br/>


**Caroline Proulx**   
Minister of Tourism   
Minister responsible for the Lanaudière region

```{r, echo=FALSE,out.width="75%",fig.show='hold',fig.align='center'}
knitr::include_graphics(here("img", "logo", "gouv_quebec_large.png"))
``` 

<br/>

---

\pagebreak

<br/>


### A word from the regional Member of the National Assembly {-}

\linebreak

```{r photo_deputee_reg, echo=TRUE, echo=FALSE, out.width= "35%", out.extra='style="float:right; padding:10px"'}

knitr::include_graphics("https://coalitionavenirquebec.org/wp-content/uploads/2018/08/photo-profil-dufour-pierre-abitibi-est.png")

```


**54^th^ edition of the Tour de Abitibi Glencore**

It is with great honor that I address you with this message for the 54^th^ edition.

It is important to note that the significance of the number 54 creates a vibration that inspires flexibility in the face of change and the enthusiastic management of structural responsibilities.

Fully aware of all the work behind the success of this type of event, the passion that drives the organization year after year is directly in symbiosis with the significance of the number 54 and serves to offer a Tour de l’Abitibi that matches the dynamism of the population of Abitibi-Témiscamingue.

I wish the best of success to all participants and organizers of this 54th edition of the Tour de l'Abitibi Glencore.

**Pierre Dufour**       
Member of parliament for Abitibi-Est  
Parliamentary assistant to the Minister of Economy, Innovation, and Energy  
Government assistant to the Minister responsible for the Abitibi-Témiscamingue region



```{r, echo=FALSE,out.width="75%",fig.show='hold',fig.align='center'}
knitr::include_graphics(here("img", "logo", "gouv_quebec_large.png"))
``` 


<!--chapter:end:../rmd/MotsBienvenue_EN.Rmd-->


<!-- Partenaires.Rmd  : document bilingue -->

```{r , eval=(lang != "FR"), results='asis', echo= FALSE}

glue("# Sponsors")
```

```{r , eval=(lang == "FR"), results='asis', echo= FALSE }

glue("# Partenaires")
```


<!-- TODO : À réviser 2024-->

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "logo", "Tableau_Partenaires.png"))

```

<!--chapter:end:../rmd/Partenaires.Rmd-->

---
editor_options: 
  chunk_output_type: console
---
# Schedule

```{r echo=FALSE}

### Voir le fichier `code/programmation.R` pour effectuer des changements ###

source(here("code","programmation.R"))

```


###  `r params$annee` Tour de l'Abitibi `r params$sponsor` - `r params$edition`th edition {-}


```{r echo=FALSE, results='asis'}

glue('<table>
    <tr>
        <td><strong>Date</strong></td>
        <td><strong>Sponsored by</strong></td>
        <td><strong>Event</strong></td>
        <td><strong>Start</strong></td>
        <td><strong>Finish</td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
     <tr>
        <td>{dfe$date[1]}</td>
        <td>{dfe$presente[1]}</td>
        <td>{dfe$epreuve[1]}</td>
        <td>{dfe$dep[1]}</td>
        <td>{dfe$arr[1]}</td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>{dfe$date[2]}</td>
        <td>{dfe$presente[2]}</td>
        <td>{dfe$epreuve[2]}</td>
        <td>{dfe$dep[2]}</td>
        <td>{dfe$arr[2]}</td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>{dfe$date[3]}</td>
        <td>{dfe$presente[3]}</td>
        <td>{dfe$epreuve[3]}</td>
        <td>{dfe$dep[3]}</td>
        <td>{dfe$arr[3]}</td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>{dfe$date[4]}</td>
        <td>{dfe$presente[4]}</td>
        <td>{dfe$epreuve[4]}</td>
        <td>{dfe$dep[4]}</td>
        <td>{dfe$arr[4]}</td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>{dfe$date[5]}</td>
        <td>{dfe$presente[5]}</td>
        <td>{dfe$epreuve[5]}</td>
        <td>{dfe$dep[5]}</td>
        <td>{dfe$arr[5]}</td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>{dfe$date[6]}</td>
        <td>{dfe$presente[6]}</td>
        <td>{dfe$epreuve[6]}</td>
        <td>{dfe$dep[6]}</td>
        <td>{dfe$arr[6]}</td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>{dfe$date[7]}</td>
        <td>{dfe$presente[7]}</td>
        <td>{dfe$epreuve[7]}</td>
        <td>{dfe$dep[7]}</td>
        <td>{dfe$arr[7]}</td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>{dfe$date[8]}</td>
        <td>{dfe$presente[8]}</td>
        <td>{dfe$epreuve[8]}</td>
        <td>{dfe$dep[8]}</td>
        <td>{dfe$arr[8]}</td>
    </tr>
</table>')


```

**Total distance :** `r sum(df$Distance_totale)` km

<!--chapter:end:../rmd/Programmation_EN.Rmd-->


<!-- CO : document biligue  -->

```{r CO_title_en, eval=(lang != "FR"), results='asis', echo= FALSE}
glue("# Organizing committee {#co}", .open = "[")
```

```{r CO_titre_fr, eval=(lang == "FR"), results='asis', echo= FALSE }
glue("# Comité organisateur {#co}", .open = "[")
```


```{r CO_membres_en, eval=(lang != "FR"), results='asis', echo= FALSE}
glue("### Organizing committee members {-}", .open = "[")
```

```{r CO_membres_fr, eval=(lang == "FR"), results='asis', echo= FALSE }
glue("### Membres du comité organisateur {-}", .open = "[")
```

```{r CO_tableau, echo=FALSE}

staff_xlsx <- here("excel", "staff.xlsx")

read_excel(staff_xlsx, sheet = "CO") %>% 
  select(role = ifelse(lang=="FR", "role_fr", "role_en"),
         noms,
         cell) %>% 
  kbl(col.names = NULL,
      escape = F, # permet de passer les <br/>
      align = c(rep('c', times = 3)),
      ) %>% 
    kable_styling("striped",      # kable_minimal
                  full_width = T) 

```



```{r CO_support_en, eval=(lang != "FR"), results='asis', echo= FALSE}
glue("### Support team {.unnumbered}", .open = "[")
```

```{r CO_support_fr, eval=(lang == "FR"), results='asis', echo= FALSE }
glue("### Équipe de soutien {.unnumbered}", .open = "[")
```

```{r CO_soutien_tableau, echo=FALSE}

read_excel(staff_xlsx, sheet = "SOUTIEN") %>% 
  select(role = ifelse(lang=="FR", "role_fr", "role_en"),
         noms) %>% 
  kbl(col.names = NULL,
      escape = F, # permet de passer les <br/>
      align = c(rep('c', times = 2)),
      ) %>% 
    kable_styling("striped",      # kable_minimal
                  full_width = T) 

```

### Commissaires {-}

```{r CO_commissaires_tableau, echo=FALSE}

read_excel(staff_xlsx, sheet = "COMM") %>% 
  select(role = ifelse(lang=="FR", "role_fr", "role_en"),
         noms) %>% 
  kbl(col.names = NULL,
      escape = F, # permet de passer les <br/>
      align = c(rep('c', times = 2)),
      ) %>% 
    kable_styling("striped",      # kable_minimal
                  full_width = T) 

```


<!-- Ajout de la liste des coureurs si existe, dans une nouvelle section  -->

```{r start_list_FR, eval=(lang == "FR" & STARTLIST_existe), results='asis', echo= FALSE }

glue("# Liste des partants {#partants}", .open = "[")

```

```{r start_list_EN, eval=(lang == "EN" & STARTLIST_existe), results='asis', echo= FALSE }

glue("# Start list {#startlist}", .open = "[")

```


```{r start_list_tableau_FR, eval=(lang == "FR" & STARTLIST_existe), results='asis', echo= FALSE }

startlist_tableau_FR()

```


```{r start_list_tableau_EN, eval=(lang == "EN" & STARTLIST_existe), results='asis', echo= FALSE }

startlist_tableau_EN()

```



<!--chapter:end:../rmd/CO.Rmd-->

---
editor_options: 
  chunk_output_type: console
---
# Daily roadmaps {#roadmaps}

```{r feuille_route_function_EN, echo=FALSE}

feuilleroute_xlsx <- here("excel", "feuilleroute.xlsx")

graphFeuilleRoute <- function(df){
    
  df %>% 
    drop_na(desc_en) %>% 
    select(" " = desc_en,
         Heures = heures) %>%
    
  kbl(escape = F, # permet de passer les <br/>
      align = c("l","c")) %>%
    
    kable_styling( "striped", # "striped",      # kable_minimal ou kable_styling
                  full_width = TRUE) %>% 
    
    row_spec(which(df$param == "reunion",), bold = T, 
             color = couleurs$brunMaillot,
             background = couleurs$orangePale) %>% 
    row_spec(which(df$param == "course",), bold = T, 
             color = couleurs$bleuTour,
             background = couleurs$jauneTour, 
             font_size = 20) %>% 
    row_spec(which(df$param == "repas",), bold = F, 
             color = couleurs$blueSprintMaire,
             background = couleurs$bluePale) %>% 
    row_spec(which(df$param == "navette",), bold = T) %>% 
    row_spec(which(df$param == "arrivee",), bold = T, 
             color = couleurs$bleuTour)
    
    
}
```

## `r dates_EN %>% filter(code=="Dim_Av") %>% pull(jsem_jour_mois_an)` {-}

```{r feuille_route_dim_av_EN, echo=FALSE}

read_excel(feuilleroute_xlsx, sheet = "DIM_AV") %>% 
  graphFeuilleRoute()

```

<br/>

## `r dates_EN %>% filter(code=="Lun_Av") %>% pull(jsem_jour_mois_an)` {-}

```{r feuille_route_lun_av_EN, echo=FALSE}

read_excel(feuilleroute_xlsx, sheet = "LUN_AV") %>% 
  graphFeuilleRoute()
```

<br/>

## `r dates_EN %>% filter(code=="Mar") %>% pull(jsem_jour_mois_an)` {-}

```{r feuille_route_mar_EN, echo=FALSE}

read_excel(feuilleroute_xlsx, sheet = "MAR") %>% 
  graphFeuilleRoute()
```

<br/>

## `r dates_EN %>% filter(code=="Mer") %>% pull(jsem_jour_mois_an)` {-}

```{r feuille_route_mer_EN, echo=FALSE}

read_excel(feuilleroute_xlsx, sheet = "MER") %>% 
  graphFeuilleRoute()
```

<br/>

## `r dates_EN %>% filter(code=="Jeu") %>% pull(jsem_jour_mois_an)` {-}

```{r feuille_route_jeu_EN, echo=FALSE}

read_excel(feuilleroute_xlsx, sheet = "JEU") %>% 
  graphFeuilleRoute()
```

<br/>

## `r dates_EN %>% filter(code=="Ven") %>% pull(jsem_jour_mois_an)` {-}

```{r feuille_route_ven_EN, echo=FALSE}

read_excel(feuilleroute_xlsx, sheet = "VEN") %>% 
  graphFeuilleRoute()
```

<br/>

## `r dates_EN %>% filter(code=="Sam") %>% pull(jsem_jour_mois_an)` {-}

```{r feuille_route_sam_EN, echo=FALSE}

read_excel(feuilleroute_xlsx, sheet = "SAM") %>% 
  graphFeuilleRoute()
```

<br/>

## `r dates_EN %>% filter(code=="Dim") %>% pull(jsem_jour_mois_an)` {-}

```{r feuille_route_dim_EN, echo=FALSE}

read_excel(feuilleroute_xlsx, sheet = "DIM") %>% 
  graphFeuilleRoute()
```

<br/>

## `r dates_EN %>% filter(code=="Lun_Ap") %>% pull(jsem_jour_mois_an)` {-}

```{r feuille_route_lun_ap_EN, echo=FALSE}

read_excel(feuilleroute_xlsx, sheet = "LUN_AP") %>% 
  graphFeuilleRoute()
```

<br/>


<!--chapter:end:../rmd/FeuillesRoute_EN.Rmd-->


<!-- Besoin de changer le # de la ville du titre et la variable Etape et codeJour -->

<!-- Version anglaise  -- AVEC circuit d'arrivée   -->

# Stage 1 : `r iti_etape$Details$Descr_Villes[1]` {#stage1}

```{r, echo=FALSE}
Etape <-1

codeJour <- "Mar"

heureDep <- iti_etape$Details$time_depart[Etape]

heureCircuit <- iti_etape$Details$HeureEntreeVille[Etape]

heureArr <- iti_etape$Details$time_arrivee[Etape]


```

```{r, echo=FALSE, results='asis'}

glue('<table border=1>
    <tr>
        <td><strong/>Powered by</strong></td>
        <td><img src="../img/logo/comm_{Etape}.png" width="350" style="float:right"></td>
    </tr>
</table>')
```

<br/>

**`r dates_EN %>% filter(code== codeJour) %>% pull(jsem_jour_mois_an)`** 

 **`r iti_etape$Details$Distance_totale[Etape]` km**


## Summary

- `r iti_etape$Details$KM_Neutres[Etape]` neutralized km from the start   
- `r iti_etape$Details$Nb_tours[Etape]` circuits laps of `r iti_etape$Details$KM_par_tours[Etape]` km


----------------------------------------------------
                                              Time
----------------- ----------------------------------
Start                                  `r heureDep`

Circuit entrance                       `r heureCircuit`

Finish                                 `r heureArr`
----------------------------------------------------

## Course

### Interactive map

```{r, echo = FALSE, eval = TRUE}


# Fonction pour affichage carte typique étape 
carte_dynamique_etape <- function(no_etape = 1){
  
  # Filtrer sur l'étape à créer et joindre à df_POI
  POI <- points %>% filter(etape == no_etape)
  
  # POI is empty ?
  poi_isEmpty <- nrow(POI) %>% as.integer()==0
    
  # Filtrer sur l'étape à créer
  etape_line <- parcours %>% filter(etape == no_etape)
    
  # Points arrivée
  pt_arrivee <- st_as_sf(st_cast(st_geometry(etape_line), to = "POINT")) %>% 
    tail(n=1) %>% 
    rename(geometry = x) %>% 
    mutate(label_fr = "Arrivée Finale",
           label_en = "Finish",
           labels = "Fin",
           etape = no_etape,
           name = "Arrivée Finale / Finish")
    
  # Création carte
  map_parcous <-mapview(parcours[Etape,],
                      layer.name = "Parcours",
                      color = couleurs$bleuTour,
                      alpha = 0.7,
                      map.types = "OpenStreetMap",
                      lwd = 3,
                      legend = FALSE)
  map_POI <- NULL
  map_POI <- if(!poi_isEmpty){
            mapview(POI ,
                    layer.name = "POI",
                    color = POI$color,
                    col.regions = POI$color,
                    alpha = 0.0,
                    map.types = "OpenStreetMap",
                    lwd = 3,
                    legend = FALSE,
                    homebutton = FALSE)
  }
    
  map_arrivee <- mapview(pt_arrivee ,
                        layer.name = "Fin",
                        color = couleurs$brunMaillot,
                        col.regions = couleurs$brunMaillot,
                        alpha = 0.0,
                        map.types = "OpenStreetMap",
                        lwd = 3,
                        legend = FALSE,
                        homebutton = FALSE)
  
  map <- map_parcous + map_POI + map_arrivee

  map@map 
}


carte_dynamique_etape(Etape)

```


<br/>


<a href="`r iti_etape$Details$Liens[Etape]`" target="blank">Link to <strong>Ride with GPS</strong></a>

<br/>

### Full course

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Full.png")))

```

<br/>

### Start details


```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Dep.png")))

```

### Finish details

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Arr.png")))

```

<!-- À modifier avec nouveau vidéo 2024

#### In video {-}
<iframe width="560" height="315" src="https://www.youtube.com/embed/7_qncxP2Dbs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<br/>
-->
## Topographic profile

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "elev", glue("Etape{Etape}_Full_{lang}.png")))

```

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "elev", glue("Etape{Etape}_Final_{lang}.png")))

```

## Detailed description

```{r echo=FALSE}


tableau_Descrip_Etape(Etape, lang)

```

<!-- impression des résultats si existent  -->

```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("## Results")
```


```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("### Stage podium {-}", .open = "[")
```


```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

podium_EN(Etape)

```



```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("### Distinctive jerseys after the stage {-}", .open = "[")
```

```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

maillots_apres_etape_tableau_EN(Etape)

```


<!--chapter:end:../rmd/Etape1_EN.Rmd-->


<!-- Besoin de changer le # de la ville du titre et la variable Etape et codeJour -->

<!-- Version anglaise  -- AVEC circuit d'arrivée   -->

# Stage 2 : `r iti_etape$Details$Descr_Villes[2]` {#stage2}

```{r, echo=FALSE}
Etape <-2

codeJour <- "Mer"

heureDep <- iti_etape$Details$time_depart[Etape]

heureCircuit <- iti_etape$Details$HeureEntreeVille[Etape]

heureArr <- iti_etape$Details$time_arrivee[Etape]


```

```{r, echo=FALSE, results='asis'}

glue('<table border=1>
    <tr>
        <td><strong/>Powered by</strong></td>
        <td><img src="../img/logo/comm_{Etape}.png" width="350" style="float:right"></td>
    </tr>
</table>')
```

<br/>

**`r dates_EN %>% filter(code== codeJour) %>% pull(jsem_jour_mois_an)`** 

 **`r iti_etape$Details$Distance_totale[Etape]` km**


## Summary

- `r iti_etape$Details$KM_Neutres[Etape]` neutralized km from the start   
- `r iti_etape$Details$Nb_tours[Etape]` circuits laps of `r iti_etape$Details$KM_par_tours[Etape]` km


----------------------------------------------------
                                              Time
----------------- ----------------------------------
Start                                  `r heureDep`

Circuit entrance                       `r heureCircuit`

Finish                                 `r heureArr`
----------------------------------------------------

## Course

### Interactive map

```{r, echo = FALSE, eval = TRUE}


# Fonction pour affichage carte typique étape 
carte_dynamique_etape <- function(no_etape = 1){
  
  # Filtrer sur l'étape à créer et joindre à df_POI
  POI <- points %>% filter(etape == no_etape)
  
  # POI is empty ?
  poi_isEmpty <- nrow(POI) %>% as.integer()==0
    
  # Filtrer sur l'étape à créer
  etape_line <- parcours %>% filter(etape == no_etape)
    
  # Points arrivée
  pt_arrivee <- st_as_sf(st_cast(st_geometry(etape_line), to = "POINT")) %>% 
    tail(n=1) %>% 
    rename(geometry = x) %>% 
    mutate(label_fr = "Arrivée Finale",
           label_en = "Finish",
           labels = "Fin",
           etape = no_etape,
           name = "Arrivée Finale / Finish")
    
  # Création carte
  map_parcous <-mapview(parcours[Etape,],
                      layer.name = "Parcours",
                      color = couleurs$bleuTour,
                      alpha = 0.7,
                      map.types = "OpenStreetMap",
                      lwd = 3,
                      legend = FALSE)
  map_POI <- NULL
  map_POI <- if(!poi_isEmpty){
            mapview(POI ,
                    layer.name = "POI",
                    color = POI$color,
                    col.regions = POI$color,
                    alpha = 0.0,
                    map.types = "OpenStreetMap",
                    lwd = 3,
                    legend = FALSE,
                    homebutton = FALSE)
  }
    
  map_arrivee <- mapview(pt_arrivee ,
                        layer.name = "Fin",
                        color = couleurs$brunMaillot,
                        col.regions = couleurs$brunMaillot,
                        alpha = 0.0,
                        map.types = "OpenStreetMap",
                        lwd = 3,
                        legend = FALSE,
                        homebutton = FALSE)
  
  map <- map_parcous + map_POI + map_arrivee

  map@map 
}


carte_dynamique_etape(Etape)

```


<br/>


<a href="`r iti_etape$Details$Liens[Etape]`" target="blank">Link to <strong>Ride with GPS</strong></a>

<br/>

### Full course

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Full.png")))

```

<br/>

### Start details


```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Dep.png")))

```

### Finish details

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Arr.png")))

```

<!-- À modifier avec nouveau vidéo 2024

#### In video {-}
<iframe width="560" height="315" src="https://www.youtube.com/embed/7_qncxP2Dbs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<br/>
-->
## Topographic profile

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "elev", glue("Etape{Etape}_Full_{lang}.png")))

```

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "elev", glue("Etape{Etape}_Final_{lang}.png")))

```

## Detailed description

```{r echo=FALSE}


tableau_Descrip_Etape(Etape, lang)

```

<!-- impression des résultats si existent  -->

```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("## Results")
```


```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("### Stage podium {-}", .open = "[")
```


```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

podium_EN(Etape)

```



```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("### Distinctive jerseys after the stage {-}", .open = "[")
```

```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

maillots_apres_etape_tableau_EN(Etape)

```


<!--chapter:end:../rmd/Etape2_EN.Rmd-->


<!-- Besoin de changer le # de la ville du titre et la variable Etape et codeJour -->

<!-- CLMI   -->

# Stage 3 : `r params$ville` - ITT {#stage3}

```{r, echo=FALSE}
Etape <-3

codeJour <- "Jeu"

heureDep <- iti_etape$Details$time_depart[Etape]

heureArr <- iti_etape$Details$time_arrivee[Etape]

heureDernierDep <- iti_etape$Details$DerDep[Etape]

heureDernierArr <- iti_etape$Details$DerArr[Etape]

```

```{r, echo=FALSE, results='asis'}

glue('<table border=1>
    <tr>
        <td><strong/>Powered by</strong></td>
        <td><img src="../img/logo/comm_{Etape}.png" width="350" style="float:right"></td>
    </tr>
</table>')
```

<br/>

**`r dates_EN %>% filter(code== codeJour) %>% pull(jsem_jour_mois_an)`** 

 **`r iti_etape$Details$Distance_totale[Etape]` km**


## Summary

- Out and bakk Individual Time Trial : 2 x 4.2 km

----------------------------------------------------
                                              Time
----------------- ----------------------------------
First start                          `r heureDep`

First finish                         `r heureArr`

Last start                           `r heureDernierDep`

Last finish                          `r heureDernierArr`
----------------------------------------------------

## Course

### Interactive map

```{r, echo = FALSE, eval = TRUE}

carte_dynamique_etape(Etape)

```


<br/>


<a href="`r iti_etape$Details$Liens[Etape]`" target="blank">Link to <strong>Ride with GPS</strong></a>

<br/>

### Full course

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Full.png")))

```

<br/>

### Start details


```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Dep.png")))

```

### Finish details

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Arr.png")))

```

#### In video {-}

<iframe width="560" height="315" src="https://www.youtube.com/embed/dPqyDCa4TwA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<br/>

## Topographic profile

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "elev", glue("Etape{Etape}_Full_{lang}.png")))

```

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "elev", glue("Etape{Etape}_Final_{lang}.png")))

```


## Detailed description

```{r echo=FALSE}

# Tableau sans footer pour le CLMI
tableau_Descrip_BASE(Etape, lang)

```

<!-- impression des résultats si existent  -->

```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("## Results")
```


```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("### Stage podium {-}", .open = "[")
```


```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

podium_EN(Etape)

```



```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("### Distinctive jerseys after the stage {-}", .open = "[")
```

```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

maillots_apres_etape_tableau_EN(Etape)

```


<!--chapter:end:../rmd/Etape3_EN.Rmd-->

<!-- Besoin de changer le # de la ville du titre et la variable Etape et codeJour -->

<!-- Version anglaise  -- SANS circuit d'arrivée   -->

# Stage 4 : `r iti_etape$Details$Descr_Villes[4]` {#stage4}

```{r, echo=FALSE}
Etape <-4

codeJour <- "Jeu"

heureDep <- iti_etape$Details$time_depart[Etape]

heureArr <- iti_etape$Details$time_arrivee[Etape]

```

```{r, echo=FALSE, results='asis'}

glue('<table border=1>
    <tr>
        <td><strong/>Powered by</strong></td>
        <td><img src="../img/logo/comm_{Etape}.png" width="350" style="float:right"></td>
    </tr>
</table>')
```

<br/>

**`r dates_EN %>% filter(code== codeJour) %>% pull(jsem_jour_mois_an)`** 

 **`r iti_etape$Details$Distance_totale[Etape]` km**


## Summary

- `r iti_etape$Details$KM_Neutres[Etape]` neutralized km from the start   
- Without circuit finish


----------------------------------------------------
                                              Time
----------------- ----------------------------------
Start                                  `r heureDep`

Finish                                 `r heureArr`
----------------------------------------------------

## Course

### Interactive map

```{r, echo = FALSE, eval = TRUE}

carte_dynamique_etape(Etape)

```


<br/>


<a href="`r iti_etape$Details$Liens[Etape]`" target="blank">Link to <strong>Ride with GPS</strong></a>

<br/>

### Full course

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Full.png")))

```

<br/>

### Start details


```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Dep.png")))

```

### Finish details

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Arr.png")))

```

<!-- En attente nouveau vidéo 2024

#### In video {-}

<iframe width="560" height="315" src="https://www.youtube.com/embed/BSmjncS_yZ0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<br/>

-->

## Topographic profile

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "elev", glue("Etape{Etape}_Full_{lang}.png")))

```

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "elev", glue("Etape{Etape}_Final_{lang}.png")))

```

<!-- impression des porteurs de maillots si existent  -->

```{r, eval=(verif_porteurs_complets(BeforeStage = Etape)), results='asis', echo= FALSE }

glue("## Jersey wearers for the stage")
```


```{r, eval=(verif_porteurs_complets(BeforeStage = Etape)), results='asis', echo= FALSE }

maillots_porteurs_tableau_EN(Etape)

```

<!-- fin porteur maillots -->

## Detailed description

```{r echo=FALSE}


tableau_Descrip_Etape_Demi(Etape, lang)

```

<!-- impression des résultats si existent  -->

```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("## Results")
```


```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("### Stage podium {-}", .open = "[")
```


```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

podium_EN(Etape)

```



```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("### Distinctive jerseys after the stage {-}", .open = "[")
```

```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

maillots_apres_etape_tableau_EN(Etape)

```


<!--chapter:end:../rmd/Etape4_EN.Rmd-->

<!-- Besoin de changer le # de la ville du titre et la variable Etape et codeJour -->

<!-- Version anglaise  -- SANS circuit d'arrivée   -->

# Stage 5 : `r iti_etape$Details$Descr_Villes[5]` {#stage5}

```{r, echo=FALSE}
Etape <-5

codeJour <- "Ven"

heureDep <- iti_etape$Details$time_depart[Etape]

heureArr <- iti_etape$Details$time_arrivee[Etape]

```

```{r, echo=FALSE, results='asis'}

glue('<table border=1>
    <tr>
        <td><strong/>Powered by</strong></td>
        <td><img src="../img/logo/comm_{Etape}.png" width="400" style="float:right"></td>
    </tr>
</table>')
```

<br/>

**`r dates_EN %>% filter(code== codeJour) %>% pull(jsem_jour_mois_an)`** 

 **`r iti_etape$Details$Distance_totale[Etape]` km**


## Summary

- `r iti_etape$Details$KM_Neutres[Etape]` neutralized km from the start   
- Counterclockwise loop
- Mountain top finich at the *Mont Bell* : General climber’s classification (KOM) are doubled (art 14.3, [Specific rules])
- Protocol ceremony at the start line, in front of Senneterre City Hall


----------------------------------------------------
                                              Time
----------------- ----------------------------------
Start                                  `r heureDep`

Finish                                 `r heureArr`
----------------------------------------------------

## Course

### Interactive map

```{r, echo = FALSE, eval = TRUE}

carte_dynamique_etape(Etape)

```


<br/>


<a href="`r iti_etape$Details$Liens[Etape]`" target="blank">Link to <strong>Ride with GPS</strong></a>

<br/>

### Full course

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Full.png")))

```

<br/>

### Start details


```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Dep.png")))

```

### Finish details

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Arr.png")))

```

#### In video {-}

<iframe width="560" height="315" src="https://www.youtube.com/embed/Z7yGlUB9rwk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<br/>


## Topographic profile

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "elev", glue("Etape{Etape}_Full_{lang}.png")))

```

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "elev", glue("Etape{Etape}_Final_{lang}.png")))

```

<!-- impression des porteurs de maillots si existent  -->

```{r, eval=(verif_porteurs_complets(BeforeStage = Etape)), results='asis', echo= FALSE }

glue("## Jersey wearers for the stage")
```


```{r, eval=(verif_porteurs_complets(BeforeStage = Etape)), results='asis', echo= FALSE }

maillots_porteurs_tableau_EN(Etape)

```

<!-- fin porteur maillots -->

## Detailed description

```{r echo=FALSE}


tableau_Descrip_Etape_Sommet(Etape, lang)

```

<!-- impression des résultats si existent  -->

```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("## Results")
```


```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("### Stage podium {-}", .open = "[")
```


```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

podium_EN(Etape)

```



```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("### Distinctive jerseys after the stage {-}", .open = "[")
```

```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

maillots_apres_etape_tableau_EN(Etape)

```


<!--chapter:end:../rmd/Etape5_EN.Rmd-->


<!-- Besoin de changer le # de la ville du titre et la variable Etape et codeJour -->

<!-- Version anglaise  -- CIRCUIT URBAIN   -->

# Stage 6 : Urbain circuit `r iti_etape$Details$VilleDep[6]` {#stage6}

```{r, echo=FALSE}
Etape <- 6

codeJour <- "Sam"

heureDep <- iti_etape$Details$time_depart[Etape]

heureArr <- iti_etape$Details$time_arrivee[Etape]

```

```{r, echo=FALSE, results='asis'}

glue('<table border=1>
    <tr>
        <td><strong/>Powered by</strong></td>
        <td><img src="../img/logo/comm_{Etape}.png" height="200" style="float:right"></td>
    </tr>
</table>')
```

<br/>

**`r dates_EN %>% filter(code== codeJour) %>% pull(jsem_jour_mois_an)`** 

 **`r iti_etape$Details$Distance_totale[Etape]` km**


## Summary

- 12 laps of a 10.4 km circuit
- Counterclockwise loop


----------------------------------------------------
                                              Time
----------------- ----------------------------------
Start                                  `r heureDep`

Finish                                 `r heureArr`
----------------------------------------------------

## Course

### Interactive map

```{r, echo = FALSE, eval = TRUE}

carte_dynamique_etape(Etape)

```


<br/>


<a href="`r iti_etape$Details$Liens[Etape]`" target="blank">Link to <strong>Ride with GPS</strong></a>

<br/>

### Full course

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Full.png")))

```

<br/>

### Start details


```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Dep.png")))

```

### Finish details

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Arr.png")))

```


## Topographic profile

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "elev", glue("Etape{Etape}_Full_{lang}.png")))

```

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "elev", glue("Etape{Etape}_Final_{lang}.png")))

```

<!-- impression des porteurs de maillots si existent  -->

```{r, eval=(verif_porteurs_complets(BeforeStage = Etape)), results='asis', echo= FALSE }

glue("## Jersey wearers for the stage")
```


```{r, eval=(verif_porteurs_complets(BeforeStage = Etape)), results='asis', echo= FALSE }

maillots_porteurs_tableau_EN(Etape)

```

<!-- fin porteur maillots -->

## Detailed description

```{r echo=FALSE}


tableau_Descrip_Etape(Etape, lang)

```

### Special notes - urban circuit {-}

- Standing feed is permitted on the 1^st^ avenue climb (500 m after the start line) 
- This feedzone is also the trash zone.

<!-- impression des résultats si existent  -->

```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("## Results")
```


```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("### Stage podium {-}", .open = "[")
```


```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

podium_EN(Etape)

```



```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("### Distinctive jerseys after the stage {-}", .open = "[")
```

```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

maillots_apres_etape_tableau_EN(Etape)

```


<!--chapter:end:../rmd/Etape6_EN.Rmd-->


<!-- Besoin de changer le # de la ville du titre et la variable Etape et codeJour -->

<!-- Version anglaise  -- AVEC circuit d'arrivée   -->

<!-- Notes spéciale pour dernière étape -->

# Stage 7 : `r iti_etape$Details$Descr_Villes[7]` {#stage7}

```{r, echo=FALSE}
Etape <-7

codeJour <- "Dim"

heureDep <- iti_etape$Details$time_depart[Etape]

heureCircuit <- iti_etape$Details$HeureEntreeVille[Etape]

heureArr <- iti_etape$Details$time_arrivee[Etape]


```

```{r, echo=FALSE, results='asis'}

glue('<table border=1>
    <tr>
        <td><strong/>Powered by</strong></td>
        <td><img src="../img/logo/comm_{Etape}.png" height="200" style="float:right"></td>
    </tr>
</table>')
```

<br/>

**`r dates_EN %>% filter(code== codeJour) %>% pull(jsem_jour_mois_an)`** 

 **`r iti_etape$Details$Distance_totale[Etape]` km**


## Summary

- `r iti_etape$Details$KM_Neutres[Etape]` neutralized km from the start   
- `r iti_etape$Details$Nb_tours[Etape]` circuits laps of `r iti_etape$Details$KM_par_tours[Etape]` km


----------------------------------------------------
                                              Time
----------------- ----------------------------------
Start                                  `r heureDep`

Circuit entrance                       `r heureCircuit`

Finish                                 `r heureArr`
----------------------------------------------------

## Course

### Interactive map

```{r, echo = FALSE, eval = TRUE}

carte_dynamique_etape(Etape)

```


<br/>


<a href="`r iti_etape$Details$Liens[Etape]`" target="blank">Link to <strong>Ride with GPS</strong></a>

<br/>

### Full course

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Full.png")))

```

<br/>

### Start details


```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Dep.png")))

```

### Finish details

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "cartes", params$input_output,  glue("Etape{Etape}_Arr.png")))

```


<!-- En attente vidéo 2024

#### In video {-}

<iframe width="560" height="315" src="https://www.youtube.com/embed/7_qncxP2Dbs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<br/>
-->

## Topographic profile

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "elev", glue("Etape{Etape}_Full_{lang}.png")))

```

```{r, out.width="100%",fig.align='center',  echo = FALSE, eval = TRUE}

knitr::include_graphics(here("img", "elev", glue("Etape{Etape}_Final_{lang}.png")))

```

<!-- impression des porteurs de maillots si existent  -->

```{r, eval=(verif_porteurs_complets(BeforeStage = Etape)), results='asis', echo= FALSE }

glue("## Jersey wearers for the stage")
```


```{r, eval=(verif_porteurs_complets(BeforeStage = Etape)), results='asis', echo= FALSE }

maillots_porteurs_tableau_EN(Etape)

```

<!-- fin porteur maillots -->

## Detailed description

```{r echo=FALSE}


tableau_Descrip_Etape(Etape, lang)

```

### Notes {-}

- Please refer to article 12 of the [specific rules][Specific rules] for the circuit arrival of this last stage.
- Standing feed is permitted on the 1^st^ avenue climb (500 m after the start line) on the circuit.
- This feedzone is also the trash zone.

<!-- impression des résultats si existent  -->

```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("## Results")
```


```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("### Stage podium {-}", .open = "[")
```


```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

podium_EN(Etape)

```



```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue("### Distinctive jerseys after the final stage {-}", .open = "[")
```

```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

maillots_apres_etape_tableau_EN(Etape)

```

```{r, eval=(verif_resultats_complets(Stage = Etape)), results='asis', echo= FALSE }

glue('<a href="https://tourabitibi.com/wp-content/uploads/2024/07/TourAbitibi2024-Etape729.pdf" target="_blank">Link to full results</a>')

```

<!--chapter:end:../rmd/Etape7_EN.Rmd-->

# Specific rules {#rules}

<!-- Liens vers PDF règlements UCI sont définis dans _LibsVars.R-->


Article 1 – Organization

:   The Tour de l’Abitibi `r params$sponsor` is a junior stage road race organized by Le Tour Cycliste de l’Abitibi Inc. (1122, 8^e^ Rue - Suite 201, Val-d'Or (Québec) J9P 3N6) under the rules and regulations of hte <a href="https://uci.org" target="blank">Union Cycliste Internationale</a> (UCI). 

    The Tour de l’Abitibi `r params$sponsor` is also sanctioned by the  <a href="https://fqsc.net/" target="blank">Fédération Québécoise des Sports Cyclistes</a> (FQSC) and <a href="https://fcyclingcanada.ca/" target="blank">Cycling Canada</a>(CC). 

    The event is regulated by the UCI rulebook and only the UCI scale of penalties will apply. The competition takes place from `r params$dates_compl`.



Article 2 – Race type

:  This race is open to athletes from the junior men’s category. It is an official UCI World Junior competition. In order to be considered as a junior athlete, one must have been born in `r params$annee - 18` ou `r params$annee - 17`. The competition is registered as a 2.NCupJ category and UCI points will be awarded following article `r glue('<a href="{uci_p2_EN}#page=190" target="_blank">2.14.040</a>')`.    

    The following waivers were granted to the organisation of the Tour de l’Abitibi by the UCI :  
    
    * The Tour de l’Abitibi allows the participation of regional and club teams only composed of junior riders but will not score any UCI points `r glue('<a href="{uci_p2_EN}#page=189" target="_blank">2.14.036</a>')`. In addition, club teams jerseys must respect articles `r glue('<a href="{uci_p1_EN}#page=81" target="_blank">1.3.045 to 1.3.047</a>')` of the UCI rules;    
    * The Tour de l’Abitibi race features two (2) half-stages on the same day (article `r glue('<a href="{uci_p2_EN}#page=60" target="_blank">2.6.010</a>')`) following the granting of a waiver from the UCI.
   
   
    
    
Article 3 – Participation
 
:   As per article 2 here above, the race is open to the following teams: National teams, regional teams, club teams and mixed teams. 

    As indicated in article `r glue('<a href="{uci_p2_EN}#page=184" target="_blank">2.14.039</a>')` of the UCI rules and regulations, the number of riders per team is a minimum of four (4) and a maximum of six (6).

    > According to the article `r glue('<a href="{uci_p2_EN}#page=20" target="_blank">2.2.023</a>')` repealed in 2023 by the UCI, there is no longer a maximum development for junior men (gear ratio).


Article 4 – Race headquarters

:   The race headquarters are at the Le Carefour high school, from Sunday `r dates_EN %>% filter(code=="Dim_Av") %>% pull(jour_mois)` to Sunday `r dates_EN %>% filter(code=="Lun_Ap") %>% pull(jour_mois_an)`, located at `r params$adresse_centrale`. Opening hours are established in function of the race schedule, but there is a security guard on duty 24 hours a day.

    Initial meeting between the Tour’s organisation and the team manager must be done at the headquarters on Sunday `r dates_EN %>% filter(code=="Dim_Av") %>% pull(jour_mois)`, between 12:00 PM and 11:00 PM and Monday `r dates_EN %>% filter(code=="Lun_Av") %>% pull(jour_mois)`, between 8:00 AM and 4:30 PM.
    
    Licence checks by the Commissaires’ Panel, identification numbers and frame plates delivery will be done on Monday `r dates_EN %>% filter(code=="Lun_Av") %>% pull(jour_mois)` between 2:00 PM and 3:30 PM.
    
    Under the UCI rules and regulations article `r glue('<a href="{uci_p1_EN}#page=43" target="_blank">1.2.087</a>')`, the mandatory sports directors’ meeting with the Commissaires’ Panel is on Tuesday `r dates_EN %>% filter(code=="Mar") %>% pull(jour_mois_an)` at 10:00 AM.


Article 5 – Caravan order

:   The order of the caravan for Stage 1 will be determined in accordance with UCI rule 2.14.046. 

    The order of the caravan for subsequent stages will be according to each team's best placed rider in the individual general classification.

    

Article 6 – Starting order for the time trial

:   The starting order of the individual time trial is the reverse order of the individual general classification after stage 2. Commissaires can modify the order to avoid two successive riders from the same team (`r glue('<a href="{uci_p2_EN}#page=64" target="_blank">2.6.023</a>')`). 

    Every rider will start with a one (1) minute gap, except for the last 10 riders which will start with two (2) minutes gap.

    Bikes must be presented and quarantined for bike check at least 15 minutes before the rider's start. 
<!-- Time-trial bikes are allowed for the Individual time trial if they respect the UCI regulations.

    An optional bike check will be offered by the commissaires on Wednesday `r dates_EN %>% filter(code=="Mer") %>% pull(jour_mois)` at 10:30 AM.-->


Article 7 – Mandatory road bike usage for time trial

:   It is the intention bikes used in the time trial must be a bike that complies with all UCI regulations for road race competition; standard road bike, standard configuration, standard handlebars (`r glue('<a href="{uci_p1_EN}#page=69" target="_blank">1.3.011-1.3.017, 1.3.020, 1.3.022</a>')`). Weight limits will aslo apply (`r glue('<a href="{uci_p1_EN}#page=68" target="_blank">1.3.019</a>')`). Further more, wheels must be approved for road race with mass start competitions (e.g., no disk or tri-spokes wheels, ref `r glue('<a href="{uci_p1_EN}#page=68" target="_blank">1.3.018</a>')`) and time trial bikes and handlebar extensions are not permitted (`r glue('<a href="{uci_p1_EN}#page=73" target="_blank">1.3.023</a>')`). Finally, Time Trial bikes and handlebar extensions defined in `r glue('<a href="{uci_p1_EN}#page=72" target="_blank">1.3.021</a>')` and `r glue('<a href="{uci_p1_EN}#page=73" target="_blank">1.3.023</a>')` are specifically not allowed in this stage.

    
Article 8 – Radio-Tour

:   All race information will be broadcasted on channel **01 – Radio-Tour** on the radio provided by the organization. 


Article 9 – Neutral technical assistance

:   The neutral technical assistance is under the Tour cycliste de l’Abitibi’s responsibility (with the exception of stage 3 – ITT). There will be three properly identified vehicles during each race (3 cars). 

    All rear wheels carried by the neutral technical assistance team will be equipped with 11 & 12-speed cassettes, with rim and disk brakes. For the teams with specials needs, please contact us at the DS meeting.


Article 10 – Time cut

:   The time cuts are set as follows:

    - The time cut is determined by adding 20% to the winner’s time for all stages, with an exception for the individual time trial, for which there is no time cut.



Article 11 – Circuit finish (Stages 1 and 2)

:  For road stages finishing with a circuit finish, the riders arriving at the circuit entry at the same time that the main peloton or the caravan is coming on the circuit will be temporarily stopped by the official to make sure there will be no interference with the other groups.    

    The time loss will be credited to their finish time.    
    
    Every rider temporarily stopped at the circuit’s entrance must then **complete all the prescribed number of laps**.
    
    If it is determined by the official at the entry of the circuit that the rider will not be able to reach the finish line within the time cut, the official will have the right to stop the rider’s race and he will not be allowed to start the next stage.


Article 12 – Circuit finish - last stage (Stage 7)

:   During the last stage, a rider stopped by the commissaire at the circuit entrance will be credited with a calculated time and won't enter the circuit. If he is already considered out of time limit relative to the first rider who entered the circuit, he will be considered ***hors délai*** **(out of the time cut)**  and will not appear on the final results.   

    On the circuit finish, a lapped rider will be pulled out of the race. He will be credited with a calculated time once he reports to the commissaires at the finish line.

    Riders that abandon during the circuit laps of the last stage will get a **DNF** result. 


Article 13 – Time bonuses

:   Bonuses will be attributed to the first three (3) of each stage except for ITT:

    * Road race (with/without circuit): 10, 6, 4 seconds, except stage 4 (half-stage): 6, 4, 2 seconds.

    Bonuses will be attributed to the first three (3) of bonus intermediate sprint:
    
    * Bonus sprint : 3, 2, 1 second.


Article 14 – Classification

:   The race is divided into five (5) different classifications:

    - General Individual Time Classification (brown jersey); `r glue('<a href="{uci_p2_EN}#page=61" target="_blank">2.6.014; 2.6.015; 2.6.019</a>')`
    - General Individual Points Classification (orange jersey); `r glue('<a href="{uci_p2_EN}#page=62" target="_blank">2.6.017</a>')`
    - General climber’s Classification (polka dot jersey). `r glue('<a href="{uci_p2_EN}#page=62" target="_blank">2.6.017</a>')`
    - General Time Classification for First Year Juniors (blue jersey);
    - General Team Classification by Time; `r glue('<a href="{uci_p2_EN}#page=61" target="_blank">2.6.016</a>')`

    If a rider is leading more than one classification, the order of priority of the distinctive jerseys shall be as follows:

    1.  Brown jersey;
    2.  Orange jersey;
    3.  Polka dot jersey;
    4.  Blue jersey;
    5.  World champion;
    6.  Continental champion;
    7.  National champion;
    8.  National team;
    9.  Regional team. 



Article 14.1 - General Individual Time Classification

:   An individual time classification is set by adding the registered time from each stage including time bonuses and penalties –UCI’s article `r glue('<a href="{uci_p2_EN}#page=61" target="_blank">2.6.014</a>')`.

    If the event of a tie, the fractions of seconds registered during the individual time trial race will be added to the total time. (UCI’s article `r glue('<a href="{uci_p2_EN}#page=61" target="_blank">2.6.015</a>')`)

    In case of a further tie, the placings obtained in each stage shall be added, and as a last resort, the classification of the last stage will be used. (UCI’s article `r glue('<a href="{uci_p2_EN}#page=61" target="_blank">2.6.015</a>')`)

    

Article 14.2 - General Individual Points Classification

:   This ranking is determined by adding the points at the end of each stage and in the intermediate sprints. 

    In the event of a tie, the riders will be awarded the amount of points attributed to their ranking.

    In the event of a tie in the general individual classification by points, the following criteria will be applied until the riders are separated : (`r glue('<a href="{uci_p2_EN}#page=62" target="_blank">2.6.017</a>')`) :
    
    1. Number of stage wins
    2. Number of wins in the intermediate sprints
    3. General individual time classification

    Points are awarded to the first ten (10) riders of a stage and the first three (3) riders of intermediate sprints:

    - Top 10 riders of a road stage : 30 – 24 – 20 – 16 – 12 – 10 – 8 – 6 – 4 – 2
    - Individual time trial : 15 – 12 – 10 – 8 – 6 – 5 – 4 – 3 – 2 – 1
    - Intermediate sprints : 6 – 4 – 2



Article 14.3 - General climber’s classification (KOM) 

:   It is determined by the addition of the points attributed at each KOM (hill sprint): 5-3-2 points, with the exception of stage 5 (summit finish) where the points are doubled (10-6-4 points).

    In the case of a tie, the following criteria will be applied until a tie breaker is reached:

    1. Number of first places in the mountain finish (stage 5);
    2. Number of first places in the hill sprints;
    3. Overall individual time classification.


Article 14.4 - General Time Classification for First Year Juniors

:   This classification is based on general individual time classification, but only involves first year juniors (17 years of age) born in `r params$annee - 17`.



Article 14.5 - General Team Classification by Time

:   The team classification for the day shall be calculated on the basis of the sum of the three (3) best individual times from each team. 

    In the event of a tie, the teams shall be separated by the sum of the places acquired by their three best times on the stage. If the teams are still tied, they shall be separated by the placing of their best rider on the stage classification. (UCI Article `r glue('<a href="{uci_p2_EN}#page=61" target="_blank">2.6.016</a>')`)

    The team general classification shall be calculated on the basis of the sum of the three best individual times from each team in each stage ridden. In the event of a draw, the following criteria shall be applied in order until the teams are separated:

    1. Number of first places in the daily team classifications;
    2. Number of second places in the daily team classifications; etc.

    If there is still a draw, the teams shall be separated by the placing of their best rider in the general individual classification.

    Any team reduced to fewer than three riders shall be eliminated from the general team classification.


Article 15 - Protest of results

:   Only the team’s manager may file a protest of the results. A protest must be transmitted to the finish line judges. 

    This request must be made within the following delay:
    
    - For placing: one hour before the start of the following stage, at the latest;
    - For overall final classification, thirty (30) minutes after the posting of the results.


Article 16 – Prizes

:     The following prizes will be awarded according to `r glue('<a href="{uci_financial}" target="_blank">UCI ROAD financial obligations</a>')`. All amounts are in canadians dollars.        

    
```{r , echo=FALSE}

df<- read_excel(here("excel", "prix.xlsx"), 
           sheet = "Etape") %>% 
  select(Postion = pos,
         Prize = montant) 

df %>% 
  mutate(Prize = currency(Prize, digits = 0)) %>% 
  kbl(
      escape = F, # permet de passer les <br/>
      align = c("c","c"),
      ) %>% 
    kable_styling("striped",      # kable_minimal
                  full_width = T) %>% 
    row_spec(which(df$Postion == "Total"), 
             bold = T, 
             color = couleurs$blueTour,
             font_size = "larger") %>% 
  add_header_above(c("Stage Individual Classification" =2),
                   font_size = "x-large",
                   background = couleurs$jauneTour)
    

```

<br/>

```{r , echo=FALSE}

df<- read_excel(here("excel", "prix.xlsx"), 
           sheet = "DemiEtape") %>% 
  select(Postion = pos,
         Prize = montant) 

df %>% 
  mutate(Prize = currency(Prize, digits = 0)) %>% 
  kbl(
      escape = F, # permet de passer les <br/>
      align = c("c","c"),
      ) %>% 
    kable_styling("striped",      # kable_minimal
                  full_width = T) %>% 
    row_spec(which(df$Postion == "Total"), 
             bold = T, 
             color = couleurs$blueTour,
             font_size = "larger") %>% 
  add_header_above(c("Half Stage Individual Classification" =2),
                   font_size = "x-large",
                   background = couleurs$jauneTour)
    

```


<br/>
    
```{r , echo=FALSE}

df<- read_excel(here("excel", "prix.xlsx"), 
           sheet = "GenTemps") %>% 
  select(Postion = pos,
         Prize = montant) 

df %>% 
  mutate(Prize = currency(Prize, digits = 0)) %>% 
  kbl(
      escape = F, # permet de passer les <br/>
      align = c("c","c"),
      ) %>% 
    kable_styling("striped",      # kable_minimal
                  full_width = T) %>% 
    row_spec(which(df$Postion == "Total"), 
             bold = T, 
             color = couleurs$blueTour,
             font_size = "larger") %>% 
  add_header_above(c("General Individual Time Classification" =2),
                   font_size = "x-large",
                   background = couleurs$brunMaillot,
                   color = "white")
    

```

<br/>
 
    
```{r , echo=FALSE}

df<- read_excel(here("excel", "prix.xlsx"), 
           sheet = "GenPoints") %>% 
  select(Postion = pos,
         Prize = montant) 

df %>% 
  mutate(Prize = currency(Prize, digits = 0)) %>% 
  kbl(
      escape = F, # permet de passer les <br/>
      align = c("c","c"),
      ) %>% 
    kable_styling("striped",      # kable_minimal
                  full_width = T) %>% 
    row_spec(which(df$Postion == "Total"), 
             bold = T, 
             color = couleurs$blueTour,
             font_size = "larger") %>% 
  add_header_above(c("General Individual Points Classification" =2),
                   font_size = "x-large",
                   background = couleurs$orangeMaillot)
    

```

<br/>
    
```{r , echo=FALSE}

df<- read_excel(here("excel", "prix.xlsx"), 
           sheet = "GenKOM") %>% 
  select(Postion = pos,
         Prize = montant) 

df %>% 
  mutate(Prize = currency(Prize, digits = 0)) %>% 
  kbl(
      escape = F, # permet de passer les <br/>
      align = c("c","c"),
      ) %>% 
    kable_styling("striped",      # kable_minimal
                  full_width = T) %>% 
    row_spec(which(df$Postion == "Total"), 
             bold = T, 
             color = couleurs$blueTour,
             font_size = "larger") %>% 
  add_header_above(c("General climber’s classification (KOM)" =2),
                   font_size = "x-large",
                   background = couleurs$vertMaillot)
    

```

<br/>
    
```{r , echo=FALSE}

df<- read_excel(here("excel", "prix.xlsx"), 
           sheet = "GenJeune") %>% 
  select(Postion = pos,
         Prize = montant) 

df %>% 
  mutate(Prize = currency(Prize, digits = 0)) %>% 
  kbl(
      escape = F, # permet de passer les <br/>
      align = c("c","c"),
      ) %>% 
    kable_styling("striped",      # kable_minimal
                  full_width = T) %>% 
    row_spec(which(df$Postion == "Total"), 
             bold = T, 
             color = couleurs$blueTour,
             font_size = "larger") %>% 
  add_header_above(c("General Time Classification for First Year Juniors" =2),
                   font_size = "x-large",
                   background = couleurs$blueSprintMaire,
                   color= "white")
    

```

<br/>
    
```{r , echo=FALSE}

df<- read_excel(here("excel", "prix.xlsx"), 
           sheet = "GenEquipe") %>% 
  select(Postion = pos,
         Prize = montant) 

df %>% 
  mutate(Prize = currency(Prize, digits = 0)) %>% 
  kbl(
      escape = F, # permet de passer les <br/>
      align = c("c","c"),
      ) %>% 
    kable_styling("striped",      # kable_minimal
                  full_width = T) %>% 
    row_spec(which(df$Postion == "Total"), 
             bold = T, 
             color = couleurs$blueTour,
             font_size = "larger") %>% 
  add_header_above(c("General Team Classification by Time" =2),
                   font_size = "x-large",
                   background = couleurs$bleuTour,
                   color = couleurs$jauneTour)
    

```

<br/>
    
```{r , echo=FALSE}

df<- read_excel(here("excel", "prix.xlsx"), 
           sheet = "Abitibien") %>% 
  select(Postion = pos,
         Prize = montant) 

df %>% 
  mutate(Prize = currency(Prize, digits = 0)) %>% 
  kbl(
      escape = F, # permet de passer les <br/>
      align = c("c","c"),
      ) %>% 
    kable_styling("striped",      # kable_minimal
                  full_width = T) %>% 
    row_spec(which(df$Postion == "Total"), 
             bold = T, 
             color = couleurs$blueTour,
             font_size = "larger") %>% 
  add_header_above(c("Best Abitibian" =2),
                   font_size = "x-large",
                   background = couleurs$jauneTour,
                   color = couleurs$bleuTour)
    

```

<br/>

```{r, echo=FALSE}

bourse_totale <- read_excel(here("excel", "prix.xlsx"), 
           sheet = "Total") %>% 
  filter(Type == "GrandTotal") %>% pull(Total) %>% currency(digits = 0) %>% str_replace(",", " ")

```

The overall amount awarded for the prizes is  **`r bourse_totale` CAD**.


<br/>

Article 17 - Special prizes

:   The winners of the special prizes are chosen by all the sport directors and the commissaires by means of a questionnaire.

    * Best Abitibian Trophy[^abitibien]
    * Relevation Trophy
    * Most Courageous Trophy
    * Most Gentlemanly Conduct Trophy
    * Most Combative Trophy
    * Best Team Spirit Trophy
    * Best Mechanic Trophy
    * Best Team Manager - Bruno Gauthier Trophy
    * MVP of each team Trophy



[^abitibien]: Rider from or living in Abitibi-Témiscamingue, according to general time classification


Article 18 – Antidoping 

:   The UCI anti-doping rules and regulations apply during this competition, where applicable, the local anti-doping legislation which will be applicable in addition to the UCI's anti-doping regulations. 

    Riders are responsible to check the list riders selected for anti-doping tests each day. 

    Failure to present when requested results in a violation to the anti-doping rules. 
 


Article 19 – Protocol

:   In compliance with the UCI rules and regulations article `r glue('<a href="{uci_p1_EN}#page=47" target="_blank">1.2.112</a>')`, the following riders must report daily for the protocol in competition attire a maximum of 10 minutes after the finish:

    * The first three (3) of the stage
    * Leaders of the following ranking: 

        * Individual time classification (brown jersey),
        * overall points classification (orange jersey), 
        * best young rider (blue jersey) and 
        * best climber (polka dot jersey).



Article 20 – Penalities

:   The UCI rules and regulations concerning penalties will apply.

    In addition, if a team car overtakes other cars of the caravan in an urban zone where overtaking is forbidden or uses dangerous driving techniques, the organising committee will send the car to the back of the caravan immediately or for the next stages. 

    If a second offence is detected or in the case of an serious infringement, the team car could be excluded completely of the caravan.



Article 21 – Emergency Services

:   According to the urban character of some of the stages and the importance accorded by the organization to the public’s security, priority will be granted to the Emergency Services in case of an accident, and everyone is expected to obey.


Article 22 – Protection of the environment and of cycling’s reputation

:   Riders are forbidden to carelessly dispose of trash or bottles along the course outside of the litter zones provided by the organiser (article `r glue('<a href="{uci_p2_EN}#page=21" target="_blank">2.2.025</a>')`). 

    Wrappers and trash must be kept by the rider or handed to the team car. Bottles may be disposed on the side of the road if spectators are present. 

    Non-compliance with this article may incur penalties (`r glue('<a href="{uci_p2_EN}#page=13" target="_blank">2.12.004, 2.12.005, 2.12.007</a>')`) or even exclusion from the race (`r glue('<a href="{uci_p2_EN}#page=14" target="_blank">2.2.010</a>')`).
    

<!--chapter:end:../rmd/Reglements_EN.Rmd-->


<!-- CirculationCourse_EN.Rmd  : version anglaise -->

# Race circulation {#circulation}

###  Road race {-}

```{r echo = FALSE, fig.align = 'center', out.width = "100%", fig.cap = "Source - [UCI - Guidelines for vehicle circulation in the race convoy, p.7](https://downloads.ctfassets.net/761l7gh5x5an/3gM8QxocLIQFMPSzjKor0v/7dafeb185ad035d43c6ab4c80b2d1ed3/2021-uci-road-guidelines-for-circulation-eng.pdf)"}

knitr::include_graphics(here("img/support/circulation_Course_EN.png"))
```

### Circuit finish (Stage 1, 2 and 7) or urban circuit (Stage 6) {-}

To ensure the safety of the riders and the local population, these specific guidelines must be followed for a circuit finish:

* All caravan vehicles must enter the finish circuit.

* Only vehicles with an essential function in the race are allowed to complete the full circuit laps. Other vehicles take the deviation before the first passage of the line.

* After stopping to assist a rider or other reason, the vehicle resumes its place in the caravan where it is. **Overtaking to return to its original place in the queue is prohibited**.

* If the stop is prolonged and a gap has formed between the caravan and its vehicle, the driver must be particularly careful when returning to the caravan, as some intersections may be open to automobile or pedestrian traffic.

* The maximum speed exceptionally tolerated in the city is **70 km/h**.

* Any **dangerous** driving will be sanctioned by the commissioners, the organization, and/or its representatives, as described in Article **20** of the [specific rules][Specific rules]. 


### Caravan deviation {-}

A deviation for vehicles is set up upstream of the finish line for each event, with the exception of stage **5** (summit finish).

```{r echo = FALSE, fig.align = 'center', out.width = "100%", fig.cap = "Source - [UCI - Guidelines for vehicle circulation in the race convoy, p.18](https://downloads.ctfassets.net/761l7gh5x5an/3gM8QxocLIQFMPSzjKor0v/7dafeb185ad035d43c6ab4c80b2d1ed3/2021-uci-road-guidelines-for-circulation-eng.pdf)"}

knitr::include_graphics(here("img/support/circulation_derivation_EN.png"))
```

### Individual time trial {-}

```{r echo = FALSE, fig.align = 'center', out.width = "100%", fig.cap = "Source - [Guidelines for vehicle circulation in the race convoy, p.30](https://downloads.ctfassets.net/761l7gh5x5an/3gM8QxocLIQFMPSzjKor0v/7dafeb185ad035d43c6ab4c80b2d1ed3/2021-uci-road-guidelines-for-circulation-eng.pdf)"}

knitr::include_graphics(here("img/support/circulation_CLMI.png"))
```

<!--chapter:end:../rmd/CirculationCourse_EN.Rmd-->

# Accommodation rules {#accomodation}

- Wear credentials **at all times** in the race headquarters. It is mandatory.
- At meals, show your credentials; take permitted quantities and empty the cabarets after use, following the recycling instructions.
- Respect 11:00 PM curfew and 11:00 AM departure time on Monday, `r dates_EN %>% filter(code=="Lun_Ap") %>% pull(jour_mois)` unless you have a special agreement with the administration.
- Repair and clean bikes in designated areas outside and do not store flammable products inside.
- In rooms, place bikes on plastic covering.
- Do not ride bikes inside the race headquarters.
- Massages must be given in rooms or in the designated massage room.
- Use of alcohol, tobacco and any other drugs are prohibited in the race headquarters and on school property.
- Deposit waste in trash cans and recycling bins to keep the race headquarters clean. Use the trash and recycling bins located near the door outside your classroom.
- Respect staff and volunteers.

<!--chapter:end:../rmd/Regl_sejour_EN.Rmd-->


<!-- Repas.Rmd  : document français -->

# Meals of the week {#meals}

### `r dates_EN %>% filter(code=="Dim_Av") %>% pull(jsem_jour_mois_an)` {-}

#### Dinner {-}

Soup and bread (1)  
Beef chili with red beans served with corn chips, cheese and sour cream.  
Pineapple upside-down cake  
Fruit: banana, apple, orange (1)  
Juice (1), milk (1), coffee


### `r dates_EN %>% filter(code=="Lun_Av") %>% pull(jsem_jour_mois_an)` {-}

#### Breakfast {-}


Vegetable frittata  
Bacon, ham, sausage  
Yogurt and granola (1)  
Assorted muffins (1)  
Fruit: banana, apple or orange (1)  
Milk (1), juice (1),coffee


#### Lunch {-}

Soup and bread (1)  
Tofu lasagna  
Caesar salad  
Assorted cookies (2)  
Milk (1), juice (1)  
Fruit: banana, apple or orange (1)


#### Dinner {-}

Soup and bread (1)  
Beef with vegetables and pasta  
Seasonal vegetables  
Sugar pie  
Milk (1), juice (1)  
Fruit: banana, apple or orange (1)

### `r dates_EN %>% filter(code=="Mar") %>% pull(jsem_jour_mois_an)` {-}

#### Breakfast {-}

Scrambled eggs  
Sausage, ham, bacon  
Plate of fruits and cheese  
Yogurt and granola (1)  
Assorted muffins (1)  
Fruit: banana, apple, orange (1)   
Milk (1), juice (1), coffee

#### Lunch {-}

Soup and bread (1)  
Meat macaroni  
Vegetable salad  
Assorted cookies (2)  
Milk (1)  
Juice (1)  
Fruit: banana, apple or orange (1)

#### Dinner {-}

Soup and bread (1)  
Butter chicken and basmati rice 
Seasonal vegetables 
Chocolate cake 
Milk (1), juice (1)  
Fruit: banana, apple or orange (1)

### `r dates_EN %>% filter(code=="Mer") %>% pull(jsem_jour_mois_an)` {-}

#### Breakfast {-}

Quiche Lorraine  
Sausage, ham, bacon  
Plate of fruits and cheese  
Yogurt and granola (1)  
Assorted muffins (1)  
Fruit: apple, banana, orange (1)   
Milk (1), juice (1), coffee

#### Lunch {-}

Soup and bread (1)  
Shepherd's pie  
Cabbage salad  
Assorted cookies (2)  
Milk (1), juice (1)  
Fruit: banana, apple or orange (1)

#### Dinner {-}

Soup and bread (1)  
Salmon fillet with egg sauce and quinoa  
Seasonal vegetables  
Sugar pudding  
Milk (1), juice (1)  
Fruit: banana, apple or orange (1)


### `r dates_EN %>% filter(code=="Jeu") %>% pull(jsem_jour_mois_an)` {-}

#### Breakfast {-}

Scrambled eggs and grilled bread  
Sausage, ham, bacon  
Plate of fruits and cheese  
Yogurt and granola (1)  
Assorted muffins (1)  
Fruit: apple, banana, orange (1)   
Milk (1), juice (1), coffee

#### Lunch {-}

Soup and bread (1)  
Chicken and vegetables *vol-au-vent*  
Potato salad  
Assorted cookies (2)  
Milk (1), juice (1)  
Fruit: banana, apple or orange (1)

#### Dinner - Malartic {-}

Lasagna

*More information to come*



### `r dates_EN %>% filter(code=="Ven") %>% pull(jsem_jour_mois_an)` {-}

#### Breakfast {-}

Vegetable frittata  
Sausage, ham, bacon  
Plate of fruits and cheese  
Yogurt and granola (1)  
Assorted muffins (1)  
Fruit: apple, banana, orange (1)   
Milk (1), juice (1), coffee

#### Lunchbox{-}

8-inch sandwich  
Pasta, rice or potato salad  
Raw vegetables and dip  
Assorted cookies (2)  
Juice (1)  
Fruit: banana, apple or orange (1)

#### Dinner - Senneterre {-}

Raw vegetables and local cheeses  
bread and butter  
Spaghetti    
Juice, water, coffee / herbal tea / tea  
Carrot and maple cupcakes



### `r dates_EN %>% filter(code=="Sam") %>% pull(jsem_jour_mois_an)` {-}

#### Breakfast {-}

Breakfast muffins  
Sausage, ham, bacon  
Plate of fruits and cheese  
Yogurt and granola (1)  
Assorted muffins (1)  
Fruit: apple, banana, orange (1)   
Milk (1), juice (1), coffee

#### Lunch {-}

Soup and bread (1)  
Shepherd's pie  
Green salad  
Assorted cookies (2)  
Milk (1), juice (1)  
Fruit: banana, apple or orange (1)

#### Dinner {-}

Soup and bread (1)  
Spanish meatball, rice and seasonal vegetable  
Black bean brownies  
Milk (1), juice (1)  
Fruit: banana, apple or orange (1)

### `r dates_EN %>% filter(code=="Dim") %>% pull(jsem_jour_mois_an)` {-}

### Breakfast {-}

Scrambled eggs  
Sausage, ham, bacon  
Plate of fruits and cheese  
Yogurt and granola (1)  
Assorted muffins (1)  
Fruit: apple, banana, orange (1)   
Milk (1), juice (1), coffee

#### Lunchbox{-}

8-inch sandwiches  
Pasta, potato or rice salad  
Raw vegetables and dip  
Dates squares  
Juice (1)  
Fruit: banana, apple or orange (1)

#### Dinner {-}

Soup and bread (1)  
Pork burger, grilled potatoes and salad  
Lemon pie  
Milk (1), juice (1)  
Fruit: banana, apple or orange (1)

### `r dates_EN %>% filter(code=="Lun_Ap") %>% pull(jsem_jour_mois_an)` {-}

#### Breakfast {-}

Breakfast lunchbox 
Fruit and cheese, juice.   
Breakfast muffins and yogurt  

<br/>

### Notes {-}

**Menu may vary <br/> <br/>The Tour Cycliste de l’Abitibi is not responsible of any allergic reactions and/or food intolerances**




<!--chapter:end:../rmd/Repas_EN.Rmd-->

---
editor_options: 
  chunk_output_type: console
---

<!-- MedMasso_EN.Rmd  -->



# Medical assistance {#medical}


Every foreign rider must have medical insurance.  

**No insurance, no racing !**

In case of serious injury which requires hospitalization or an operation, the insurance must cover all administrative and medical charges. A team manager may have to pay the fees directly at the hospital pending the reimbursement by the insurance.



### Hospital list {-}

```{r, echo=FALSE}
resp_medical <- read_excel(staff_xlsx, sheet = "CO") %>% 
  filter(role_en == 'Medical')

```

| City          | Adress                 | Phone          |
| :------------ | :--------------------- | :------------- |
| Val-d'Or      | 725, 6^e^ rue            | (819) 855-5858 |
| Amos          | 622, 4^e^ rue Ouest      | (819) 732-3341 |
| Rouyn-Noranda | 4, 9^e^ rue              | (819) 764-5131 |
| Malartic      | 1141, rue Royale       | (819) 757-4342 |
| Senneterre    | 961,rue de la Clinique | (819) 825-5858 | 
| La Sarre      | 679 2^e^ Rue Est           | (819) 333-2311 | 

<br/> 
<div style="background-color: #ffaca3; border-radius: 5px; border: 2px solid#ff3924; padding: 3px;">
  <p>Please contact the person in charge of the medical comitee **before** going to the hospital:</p> 
  <p style="justify-content: center; align-items: center;margin:10px 100px 20px 20px;">
    <table style="width:100%;text-align:center;"> 
      <tr> 
        <td width="50%"> `r resp_medical %>% pull(noms)` </td> 
        <td width="50%"> `r resp_medical %>% pull(cell)`  </td> 
      </tr> 
    </table>
  </p>
</div>


### Medical clinic schedule {-}

```{r horraire_med_EN, echo=FALSE}

med_xlsx <- here("excel", "med_masso.xlsx")

df <- read_excel(med_xlsx, sheet = "MEDICAL") 

left_join(x= df, y= dates_EN, by= "code") %>% 
  select(Date = jsem_jour_mois,
         "Opening hours" = heures) %>%   
  kbl(escape = F, # permet de passer les <br/>
      align = c("l","c")) %>% 
    kable_styling("striped",      # kable_minimal
                  full_width = TRUE) 
```


Outside these hours, cyclists should contact the reception desk to communicate with the medical team.

The medical team will be present at the starting line 1h before each race and at the finish line 30 minutes after the arrival.


### Massage clinic schedule {-}

In order to benefit from massage therapy, please register at the local in advance.

**Fees** : 20 mins session - payable in cash on site 

```{r horraire_med_EN_2, echo=FALSE}

med_xlsx <- here("excel", "med_masso.xlsx")

df <- read_excel(med_xlsx, sheet = "MASSO") 

left_join(x= df, y= dates_EN, by= "code") %>% 
  select(Date = jsem_jour_mois,
         "Opening hours" = hours) %>%   
  kbl(escape = F, # permet de passer les <br/>
      align = c("l","c")) %>% 
    kable_styling("striped",      # kable_minimal
                  full_width = TRUE) 
```

### VIP schedule {-}

All 18 years old or older coaches, mechanics, therapists, volunteers and sponsors are invited to the *salon VIP*.

From sunday `r dates_EN %>% filter(code=="Dim_Av") %>% pull(jour_mois)` to sunday `r dates_EN %>% filter(code=="Dim") %>% pull(jour_mois)`, 9PM to 3AM.


<!--chapter:end:../rmd/MedMasso_EN.Rmd-->


<!-- Locaux.Rmd  : document bilingue -->

```{r locaux_title_en, eval=(lang != "FR"), results='asis', echo= FALSE}

glue("# List of rooms {#rooms}", .open = "[")
```

```{r locaux_titre_fr, eval=(lang == "FR"), results='asis', echo= FALSE }

glue("# Liste des locaux {#locaux}", .open = "[")
```



```{r team_room_en, eval=(lang != "FR"), results='asis', echo= FALSE}
glue("### Teams rooms {-}", .open = "[")
```

```{r team_room_fr, eval=(lang == "FR"), results='asis', echo= FALSE }
glue("### Locaux des équipes {-}", .open = "[")
```


```{r team_room_tableau, echo=FALSE}

locaux_xlsx <- here("excel", "locaux.xlsx")

# Note : mettre en ordre manuellement dans le fichier excel selon l'ordre des dossards !

read_excel(locaux_xlsx, sheet = "EQUIPES") %>% 
  select(role = ifelse(lang=="FR", "equipe_fr", "equipe_en"),
         room) %>% 
  kbl(col.names = NULL,
      escape = F, # permet de passer les <br/>
      align = c("l","r"),
      ) %>% 
    kable_styling("striped",      # kable_minimal
                  full_width = TRUE) 

```
<br/>

```{r staff_room_en, eval=(lang != "FR"), results='asis', echo= FALSE}
glue("### Administratives rooms {-}", .open = "[")
```

```{r staff_room_fr, eval=(lang == "FR"), results='asis', echo= FALSE }
glue("### Locaux administratifs {-}", .open = "[")
```


```{r admin_room_tableau, echo=FALSE}

locaux_xlsx <- here("excel", "locaux.xlsx")

read_excel(locaux_xlsx, sheet = "ADMIN") %>% 
  select(role = ifelse(lang=="FR", "commite_fr", "commite_en"),
         room = ifelse(lang=="FR", "room_fr", "room_en")) %>% 
  arrange(role) %>% 
  kbl(col.names = NULL,
      escape = F, # permet de passer les <br/>
      align = c("l","r"),
      ) %>% 
    kable_styling("striped",      # kable_minimal
                  full_width = TRUE) 

```

<!--chapter:end:../rmd/Locaux.Rmd-->


<!-- CarteAbitibi.Rmd  : document bilingue -->

```{r carte_title_en, eval=(lang != "FR"), results='asis', echo= FALSE}

glue("# General map of Abitibi-Témiscamingue {#carteabitibi}", .open = "[")
```

```{r carte_titre_fr, eval=(lang == "FR"), results='asis', echo= FALSE }

glue("# Carte générale de l'Abitibi-Témiscamingue {#mapabitibi}", .open = "[")
```

```{r echo = FALSE, fig.align = 'center', out.width = "100%", fig.cap = "Source - [L'Observatoire de l'Abitibi-Témiscamingue](https://www.observat.qc.ca/atlas)"}

knitr::include_graphics("https://www.observat.qc.ca/documents/atlas-galerie/1-carte-abitibi-temiscamingue-d-villes-villages-region-08-at-mrc-hr.jpg")
```

<!--chapter:end:../rmd/CarteAbitibi.Rmd-->

